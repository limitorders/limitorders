import { createApp } from 'vue'
import App from './App.vue'
import router from './router'
import './index.css'


/*

deploy logic 
fill logic's address into sol file
copy proxy bytecode and factory bytecode
deploy factory
fill factory's address below

 */

window.FactoryAddress = "0x8cbF0be6e54f79699e7fDf9fa77B7FA910e22d30"

window.ISODateExample = "2009-01-03T06:15:00.000Z"

window.logicBytecode = "0x608060405234801561001057600080fd5b50610740806100206000396000f3fe608060405234801561001057600080fd5b50600436106100575760003560e01c80635fec398d1461005c5780636f41d28e1461007157806375f3147014610084578063f0fa2fe5146100ad578063fa239b1e146100c0575b600080fd5b61006f61006a36600461057a565b6100d7565b005b61006f61007f3660046105ec565b61017d565b6100976100923660046105ec565b610209565b6040516100a4919061064d565b60405180910390f35b61006f6100bb36600461057a565b61031c565b6100c960015481565b6040519081526020016100a4565b60005461010090046001600160a01b031633146101275760405162461bcd60e51b81526020600482015260096024820152683737ba16b7bbb732b960b91b60448201526064015b60405180910390fd5b61016960015483838080601f01602080910402602001604051908101604052809392919081815260200183838082843760009201919091525061037e92505050565b6001805461017691610695565b6001555050565b60005461010090046001600160a01b031633146101c85760405162461bcd60e51b81526020600482015260096024820152683737ba16b7bbb732b960b91b604482015260640161011e565b6000600180546101d891906106ad565b90508082146101fa5760006101ec82610209565b90506101f8838261037e565b505b6102038161047f565b60015550565b606060008260405160200161022091815260200190565b60408051601f1981840301815290829052915060009081906127129061024a90859060240161064d565b60408051601f198184030181529181526020820180516001600160e01b031663d6d7d52560e01b1790525161027f9190610631565b600060405180830381855af49150503d80600081146102ba576040519150601f19603f3d011682016040523d82523d6000602084013e6102bf565b606091505b50915091508180156102d357506040815110155b6103115760405162461bcd60e51b815260206004820152600f60248201526e1cd95c0c4c0c4b59d95d0b59985a5b608a1b604482015260640161011e565b604001949350505050565b60005460ff1661032b57600080fd5b61036c600083838080601f01602080910402602001604051908101604052809392919081815260200183838082843760009201919091525061037e92505050565b5050600180556000805460ff19169055565b60008260405160200161039391815260200190565b60408051601f198184030181529082905291506000908190612712906103bf9085908790602401610667565b60408051601f198184030181529181526020820180516001600160e01b03166350c63a8f60e11b179052516103f49190610631565b600060405180830381855af49150503d806000811461042f576040519150601f19603f3d011682016040523d82523d6000602084013e610434565b606091505b5091509150816104785760405162461bcd60e51b815260206004820152600f60248201526e1cd95c0c4c0c4b5cd95d0b59985a5b608a1b604482015260640161011e565b5050505050565b60008160405160200161049491815260200190565b60408051601f198184030181526000808452602084019092529250806127126104c1858560448101610667565b60408051601f198184030181529181526020820180516001600160e01b03166350c63a8f60e11b179052516104f69190610631565b600060405180830381855af49150503d8060008114610531576040519150601f19603f3d011682016040523d82523d6000602084013e610536565b606091505b5091509150816104785760405162461bcd60e51b815260206004820152600f60248201526e1cd95c0c4c0c4b59195b0b59985a5b608a1b604482015260640161011e565b6000806020838503121561058d57600080fd5b823567ffffffffffffffff808211156105a557600080fd5b818501915085601f8301126105b957600080fd5b8135818111156105c857600080fd5b8660208285010111156105da57600080fd5b60209290920196919550909350505050565b6000602082840312156105fe57600080fd5b5035919050565b6000815180845261061d8160208601602086016106c4565b601f01601f19169290920160200192915050565b600082516106438184602087016106c4565b9190910192915050565b6020815260006106606020830184610605565b9392505050565b60408152600061067a6040830185610605565b828103602084015261068c8185610605565b95945050505050565b600082198211156106a8576106a86106f4565b500190565b6000828210156106bf576106bf6106f4565b500390565b60005b838110156106df5781810151838201526020016106c7565b838111156106ee576000848401525b50505050565b634e487b7160e01b600052601160045260246000fdfea2646970667358221220f2186789a021b4576c4ca13b68455cf92319f1d2b819364a94ddb4ddd750c55364736f6c63430008060033"

window.proxyCode = "0x608060405234801561001057600080fd5b5060405161011b38038061011b83398101604081905261002f91610063565b6000805460ff196001600160a01b0390931661010002929092166001600160a81b0319909216919091176001179055610093565b60006020828403121561007557600080fd5b81516001600160a01b038116811461008c57600080fd5b9392505050565b607a806100a16000396000f3fe608060405236600a57005b604051735fcce607fede87b9b33277ead171aa4877b6274f9036600082376000803683855af43d806000843e8180156040578184f35b8184fdfea26469706673582212202eec02c202b739524692278eed4c0f2e0b0cf284133d6b408543f7a5a3e9c8a764736f6c63430008060033"

window.factoryBytecode = "0x608060405234801561001057600080fd5b506104b2806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c8063ae22c57d1461003b578063cf5ba53f1461006a575b600080fd5b61004e610049366004610238565b61007f565b6040516001600160a01b03909116815260200160405180910390f35b61007d610078366004610268565b610149565b005b600080604051806020016100929061022b565b601f1982820381018352601f9091011660408181526001600160a01b038616602083015291925060009183910160408051601f19818403018152908290526100dd9291602001610315565b60408051601f1981840301815282825280516020918201206001600160f81b0319828501523060601b6bffffffffffffffffffffffff19166021850152600060358501526055808501919091528251808503909101815260759093019091528151910120949350505050565b60008060001b3360405161015c9061022b565b6001600160a01b0390911681526020018190604051809103906000f590508015801561018c573d6000803e3d6000fd5b5060405163f0fa2fe560e01b81529091506001600160a01b0382169063f0fa2fe5906101be9086908690600401610332565b600060405180830381600087803b1580156101d857600080fd5b505af11580156101ec573d6000803e3d6000fd5b50506040516001600160a01b03841692503391507f317bcb6686b1a5aeb829655c8a343994419551e7545c04dda5edbaa31fa80d8f90600090a3505050565b61011b8061036283390190565b60006020828403121561024a57600080fd5b81356001600160a01b038116811461026157600080fd5b9392505050565b6000806020838503121561027b57600080fd5b823567ffffffffffffffff8082111561029357600080fd5b818501915085601f8301126102a757600080fd5b8135818111156102b657600080fd5b8660208285010111156102c857600080fd5b60209290920196919550909350505050565b6000815160005b818110156102fb57602081850181015186830152016102e1565b8181111561030a576000828601525b509290920192915050565b600061032a61032483866102da565b846102da565b949350505050565b60208152816020820152818360408301376000818301604090810191909152601f909201601f1916010191905056fe608060405234801561001057600080fd5b5060405161011b38038061011b83398101604081905261002f91610063565b6000805460ff196001600160a01b0390931661010002929092166001600160a81b0319909216919091176001179055610093565b60006020828403121561007557600080fd5b81516001600160a01b038116811461008c57600080fd5b9392505050565b607a806100a16000396000f3fe608060405236600a57005b604051735fcce607fede87b9b33277ead171aa4877b6274f9036600082376000803683855af43d806000843e8180156040578184f35b8184fdfea26469706673582212202eec02c202b739524692278eed4c0f2e0b0cf284133d6b408543f7a5a3e9c8a764736f6c63430008060033a26469706673582212202854ae658a79ced48c794f51364adb0f0d8e781a39aedb7b157bf8b1bdf1adce64736f6c63430008060033"

window.MemoABI = [
  "function addMemo(bytes calldata memo) external",
  "function deleteMemo(uint i) external",
  "function memoCount() external view returns (uint)",
  "function getMemo(uint i) external view returns (bytes memory memo)"]

window.alertNoWallet = () => {
      alert("No wallet installed! Please install MetaMask or other web3 wallet to use this App.");
}

window.getMyContract = function(addr) {
  const addr32 = ethers.utils.hexZeroPad(addr, 32)
  const deployCode = window.proxyCode+addr32.substr(2) // using substr to skip 0x
  const deployCodeHash = ethers.utils.keccak256(deployCode)
  return ethers.utils.getCreate2Address(window.FactoryAddress, ethers.utils.hexZeroPad("0x0", 32), deployCodeHash);
}

//window.hexFromUint8Array = function(arr) {
//  return "0x"+arr.map(x => x.toString(16).padStart(2, '0')).join('');
//}

if (typeof window.ethereum === 'undefined') {
  alertNoWallet()
} else {
  ethereum.request({ method: 'eth_requestAccounts' })
}

createApp(App).use(router).mount('#app')

